# 81. Elastic Load Balancer - Cross Zone Load Balancing

## üåê **Cross Zone Load Balancing** trong AWS

---

### üîÑ **Cross Zone Load Balancing l√† g√¨?**

* L√† c∆° ch·∫ø gi√∫p **ph√¢n ph·ªëi ƒë·ªÅu l∆∞u l∆∞·ª£ng (traffic)** ƒë·∫øn **t·∫•t c·∫£ c√°c EC2 instances** trong **m·ªçi Availability Zone (AZ)**, **kh√¥ng ph·ª• thu·ªôc AZ n√†o nh·∫≠n traffic ban ƒë·∫ßu**.
* Gi√∫p tr√°nh t√¨nh tr·∫°ng **m·∫•t c√¢n b·∫±ng t·∫£i** gi·ªØa c√°c AZ khi s·ªë l∆∞·ª£ng instance kh√¥ng ƒë·ªÅu nhau.

---

### üìä **V√≠ d·ª• minh h·ªça:**

* C√≥ 2 AZ:

  * **AZ1**: 1 Load Balancer + 2 EC2 instances.
  * **AZ2**: 1 Load Balancer + 8 EC2 instances.
* T·ªïng c·ªông c√≥ **10 EC2 instances** ƒëƒÉng k√Ω c√πng m·ªôt **Application Load Balancer (ALB)**.

#### ‚úÖ **Khi b·∫≠t Cross Zone Load Balancing:**

* M·ªói ALB instance s·∫Ω **ph√¢n ph·ªëi ƒë·ªÅu traffic ƒë·∫øn to√†n b·ªô 10 EC2 instances**, b·∫•t k·ªÉ AZ n√†o.
* M·ªói instance nh·∫≠n **10% traffic**.

#### ‚ùå **Khi t·∫Øt Cross Zone Load Balancing:**

* M·ªói ALB ch·ªâ g·ª≠i traffic ƒë·∫øn c√°c **instance trong AZ c·ªßa ch√≠nh n√≥**.
* Traffic b·ªã gi·ªõi h·∫°n trong t·ª´ng AZ => n·∫øu s·ªë l∆∞·ª£ng instance kh√¥ng ƒë·ªÅu th√¨ d·∫´n ƒë·∫øn **m·∫•t c√¢n b·∫±ng t·∫£i**:

  * AZ1 (2 instance) chia nhau 50% traffic ‚Üí m·ªói c√°i 25%.
  * AZ2 (8 instance) chia 50% c√≤n l·∫°i ‚Üí m·ªói c√°i \~6.25%.

---

### ‚öôÔ∏è **H√†nh vi m·∫∑c ƒë·ªãnh theo lo·∫°i Load Balancer:**

| Lo·∫°i Load Balancer                  | Cross Zone Load Balancing | Chi ph√≠ d·ªØ li·ªáu gi·ªØa AZs |
| ----------------------------------- | ------------------------- | ------------------------ |
| **Application Load Balancer (ALB)** | **B·∫≠t m·∫∑c ƒë·ªãnh**          | **Mi·ªÖn ph√≠**             |
| **Network Load Balancer (NLB)**     | **T·∫Øt m·∫∑c ƒë·ªãnh**          | **T√≠nh ph√≠ n·∫øu b·∫≠t**     |
| **Gateway Load Balancer (GLB)**     | **T·∫Øt m·∫∑c ƒë·ªãnh**          | **T√≠nh ph√≠ n·∫øu b·∫≠t**     |
| **Classic Load Balancer (CLB)**     | **T·∫Øt m·∫∑c ƒë·ªãnh**          | **Mi·ªÖn ph√≠ n·∫øu b·∫≠t**     |

---

### üõ†Ô∏è **C·∫•u h√¨nh Cross Zone Load Balancing:**

* **ALB**:

  * M·∫∑c ƒë·ªãnh **b·∫≠t t·∫°i c·∫•p ƒë·ªô Load Balancer**.
  * C√≥ th·ªÉ **t·∫Øt/b·∫≠t ri√™ng t·∫°i Target Group** b·∫±ng c√°ch ch·ªçn:

    * **Inherit from Load Balancer**
    * **On**
    * **Off**

* **NLB v√† GLB**:

  * M·∫∑c ƒë·ªãnh **t·∫Øt**.
  * C√≥ th·ªÉ b·∫≠t t·∫°i m·ª•c **Attributes** trong Load Balancer, nh∆∞ng **s·∫Ω ph√°t sinh chi ph√≠ li√™n AZ**.

---

### üí¨ **K·∫øt lu·∫≠n:**

| ∆Øu ƒëi·ªÉm khi b·∫≠t Cross Zone LB         | H·∫°n ch·∫ø c√≥ th·ªÉ g·∫∑p                        |
| ------------------------------------- | ----------------------------------------- |
| ‚úÖ Ph√¢n ph·ªëi t·∫£i ƒë·ªìng ƒë·ªÅu              | ‚ùå C√≥ th·ªÉ ph√°t sinh ph√≠ (NLB, GLB)         |
| ‚úÖ Tr√°nh m·∫•t c√¢n b·∫±ng gi·ªØa AZs         | ‚ùå C√≥ th·ªÉ ·∫£nh h∆∞·ªüng hi·ªáu nƒÉng n·∫øu nhi·ªÅu AZ |
| ‚úÖ ƒê∆°n gi·∫£n h√≥a vi·ªác thi·∫øt k·∫ø h·ªá th·ªëng |                                           |

---

### üìå **L∆∞u √Ω cu·ªëi c√πng:**

* **Classic Load Balancer (CLB)** s·∫Øp **b·ªã ng∆∞ng h·ªó tr·ª£**, n√™n kh√¥ng c·∫ßn t·∫≠p trung √¥n cho c√°c k·ª≥ thi m·ªõi.
* Khi kh√¥ng c·∫ßn n·ªØa, n√™n **x√≥a Load Balancer** ƒë·ªÉ tr√°nh t·ªën chi ph√≠.

---

