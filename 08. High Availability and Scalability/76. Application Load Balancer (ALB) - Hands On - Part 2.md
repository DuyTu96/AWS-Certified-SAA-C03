# 76. Application Load Balancer (ALB) - Hands On - Part 2

## ğŸ” 1. **TÄƒng cÆ°á»ng báº£o máº­t máº¡ng (Network Security)**

### ğŸ¯ Má»¥c tiÃªu:
- **Chá»‰ cho phÃ©p EC2 instance nháº­n traffic tá»« Load Balancer**, khÃ´ng cho phÃ©p truy cáº­p trá»±c tiáº¿p qua Public IP.

### ğŸ› ï¸ Thá»±c hiá»‡n:
1. Truy cáº­p **Security Group** cá»§a EC2 instance (vÃ­ dá»¥: `launch-wizard-1`).
2. VÃ o pháº§n **Inbound rules** â†’ **XÃ³a rule HTTP hiá»‡n táº¡i** (cho phÃ©p tá»« má»i nÆ¡i).
3. ThÃªm **rule HTTP má»›i**:
   - **Source**: lÃ  **Security Group cá»§a Load Balancer** (gÃµ "load" Ä‘á»ƒ tÃ¬m).
4. LÆ°u láº¡i â†’ EC2 instance **chá»‰ nháº­n traffic Ä‘áº¿n tá»« Load Balancer**.

### ğŸ§ª Kiá»ƒm tra:
- Truy cáº­p trá»±c tiáº¿p báº±ng Public IP cá»§a EC2 â†’ **bá»‹ timeout**.
- Truy cáº­p qua **Load Balancer DNS** â†’ váº«n hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng.

âœ… Káº¿t quáº£: TÄƒng cÆ°á»ng báº£o máº­t báº±ng cÃ¡ch cÃ´ láº­p EC2 instance khá»i truy cáº­p cÃ´ng khai.

---

## âš™ï¸ 2. **Application Load Balancer (ALB) Rules nÃ¢ng cao**

### ğŸ¯ Má»¥c tiÃªu:
- Thiáº¿t láº­p **Listener Rules** Ä‘á»ƒ phÃ¢n luá»“ng truy cáº­p theo Ä‘iá»u kiá»‡n cá»¥ thá»ƒ.

### ğŸ› ï¸ Thá»±c hiá»‡n:
1. Truy cáº­p ALB â†’ pháº§n **Listeners** â†’ chá»n listener (port 80) â†’ **Add Rule**.
2. **TÃªn rule**: `DemoRule`.
3. **Condition**: theo **path** â†’ `/error`.
4. **Action**:
   - Tráº£ vá» **fixed response**: HTTP status `404 Not Found`, ná»™i dung: `"custom error"`.
5. **Priority**: Ä‘áº·t lÃ  `5` (Æ°u tiÃªn cao hÆ¡n default rule).

> CÃ³ thá»ƒ táº¡o nhiá»u **conditions**: theo **host header**, **HTTP method**, **query string**, **source IP**, v.v.

---

### ğŸ§ª Kiá»ƒm tra:
- Truy cáº­p DNS cá»§a Load Balancer vá»›i `/error`:
  ```
  http://<ALB-DNS>/error
  ```
  â†’ nháº­n Ä‘Æ°á»£c **404 - custom error**.

âœ… Káº¿t quáº£: Rule `/error` Ä‘Æ°á»£c **kÃ­ch hoáº¡t Ä‘Ãºng** vÃ  tráº£ vá» ná»™i dung cá»‘ Ä‘á»‹nh.

---

## âœ… Tá»•ng káº¿t
- ÄÃ£ **siáº¿t cháº·t báº£o máº­t** báº±ng cÃ¡ch chá»‰ cho phÃ©p **traffic tá»« Load Balancer** Ä‘áº¿n EC2.
- Táº¡o Ä‘Æ°á»£c **Listener Rules** Ä‘á»ƒ kiá»ƒm soÃ¡t cÃ¡ch ALB xá»­ lÃ½ request theo Ä‘iá»u kiá»‡n cá»¥ thá»ƒ nhÆ° **path**.
- Há»‡ thá»‘ng giá» Ä‘Ã¢y an toÃ n vÃ  linh hoáº¡t hÆ¡n.

---
