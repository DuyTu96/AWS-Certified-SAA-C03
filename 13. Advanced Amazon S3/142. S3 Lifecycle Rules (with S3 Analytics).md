## 🔄 **Chuyển đổi object giữa các S3 Storage Class**

* **Diagram** minh họa cách **chuyển đổi giữa các Storage Class**:

  * Từ `Standard` → `Standard-IA` → `Intelligent-Tiering` → `One-Zone-IA`
  * Từ `One-Zone-IA` → `Glacier Flexible Retrieval` hoặc `Glacier Deep Archive`
* Nếu object **ít được truy cập**, hãy chuyển sang `Standard-IA`.
* Nếu object cần **lưu trữ lâu dài**, hãy chuyển sang các tier **Glacier** hoặc **Deep Archive**.

---

## ⚙️ **Tự động hóa bằng Lifecycle Rule**

### 1. **Transition Action**

* Dùng để **chuyển đổi Storage Class** theo thời gian.
* Ví dụ:

  * Sau **60 ngày**, chuyển object sang `Standard-IA`.
  * Sau **6 tháng**, chuyển sang `Glacier`.

### 2. **Expiration Action**

* Dùng để **xóa object** sau một khoảng thời gian.
* Ví dụ:

  * Xóa **log files** sau **365 ngày**.
  * Xóa các **object version cũ** (nếu bật versioning).
  * Xóa các **multi-part upload** chưa hoàn tất sau **14 ngày**.

### 3. **Phạm vi áp dụng Rule**

* Rule có thể áp dụng cho:

  * **Toàn bộ bucket**
  * **Prefix** cụ thể (ví dụ: `images/source/`)
  * **Object Tags** (ví dụ: tag `department=finance`)

---

## 🧩 **Tình huống thực tế**

### 🔸 **Tình huống 1: Xử lý ảnh và thumbnail**

* Ứng dụng EC2 tải ảnh gốc và tạo thumbnail lên S3.
* **Ảnh gốc**: Lưu ở `Standard`, chuyển sang `Glacier` sau **60 ngày**.
* **Thumbnail**: Lưu ở `One-Zone-IA`, xóa sau **60 ngày**.
* Dùng **prefix** để phân biệt (`source/` vs `thumbnail/`).

### 🔸 **Tình huống 2: Phục hồi object đã xóa**

* Yêu cầu:

  * Trong **30 ngày đầu**: Phục hồi **ngay lập tức**.
  * Sau đó **tối đa 365 ngày**: Phục hồi trong **vòng 48 giờ**.
* Giải pháp:

  * Bật **S3 Versioning** → Object xóa đi chỉ tạo **delete marker**.
  * Tạo rule để:

    * Chuyển **non-current versions** sang `Standard-IA`.
    * Sau đó tiếp tục chuyển sang `Glacier Deep Archive`.

---

## 📊 **Tối ưu hóa Lifecycle Rule với S3 Analytics**

* **Amazon S3 Analytics** giúp xác định **thời gian tối ưu** để chuyển class.
* Cung cấp **khuyến nghị** giữa `Standard` và `Standard-IA`.
* Không hỗ trợ `One-Zone-IA` hoặc `Glacier`.
* Kết quả dạng **CSV Report**, cập nhật **mỗi ngày**.
* Mất từ **24–48 giờ** để bắt đầu có dữ liệu.
* Dùng report này để **xây dựng hoặc cải tiến lifecycle rule**.

---

## ✅ **Tổng kết**

* Việc **chuyển đổi Storage Class** giúp tối ưu **chi phí và hiệu quả lưu trữ**.
* Có thể thực hiện **thủ công** hoặc **tự động bằng Lifecycle Rule**.
* **S3 Versioning** và **Analytics** là công cụ mạnh giúp quản lý dữ liệu tốt hơn.
* Luôn áp dụng các rule theo **prefix** hoặc **tags** để phân loại dữ liệu chính xác.

---
