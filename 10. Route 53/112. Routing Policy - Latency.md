## ğŸŒ Route 53 - **Latency-based Routing Policy**

### 1. **Latency-based Routing Policy** lÃ  gÃ¬?

* LÃ  má»™t chÃ­nh sÃ¡ch Ä‘á»‹nh tuyáº¿n giÃºp **chuyá»ƒn hÆ°á»›ng request** Ä‘áº¿n **resource cÃ³ Ä‘á»™ trá»… tháº¥p nháº¥t**.
* ThÃ­ch há»£p khi **Ä‘á»™ trá»… (latency)** lÃ  yáº¿u tá»‘ quan trá»ng hÃ ng Ä‘áº§u Ä‘á»‘i vá»›i website hoáº·c á»©ng dá»¥ng.
* **Route 53** sáº½ Ä‘á»‹nh tuyáº¿n ngÆ°á»i dÃ¹ng Ä‘áº¿n **AWS Region** gáº§n nháº¥t cÃ³ Ä‘á»™ trá»… tháº¥p nháº¥t dá»±a trÃªn Ä‘á»‹a lÃ½.

---

### 2. CÃ¡ch hoáº¡t Ä‘á»™ng

* **Route 53** Ä‘o Ä‘á»™ trá»… **dá»±a trÃªn khoáº£ng thá»i gian pháº£n há»“i giá»¯a ngÆ°á»i dÃ¹ng vÃ  region** cá»§a má»—i báº£n ghi DNS.
* VÃ­ dá»¥: NgÆ°á»i dÃ¹ng á»Ÿ Äá»©c nhÆ°ng Ä‘á»™ trá»… Ä‘áº¿n US tháº¥p hÆ¡n thÃ¬ sáº½ Ä‘Æ°á»£c **redirect Ä‘áº¿n resource á»Ÿ US**.
* CÃ³ thá»ƒ **káº¿t há»£p vá»›i Health Check** Ä‘á»ƒ chá»‰ Ä‘á»‹nh Ä‘iá»u kiá»‡n redirect dá»±a trÃªn tÃ¬nh tráº¡ng hoáº¡t Ä‘á»™ng cá»§a resource.

---

### 3. Minh há»a:

Giáº£ sá»­ báº¡n triá»ƒn khai á»©ng dá»¥ng á»Ÿ 2 region:

* `us-east-1` (Bá» ÄÃ´ng Hoa Ká»³)
* `ap-southeast-1` (Singapore)

NgÆ°á»i dÃ¹ng:

* á» Má»¹ sáº½ Ä‘Æ°á»£c chuyá»ƒn hÆ°á»›ng Ä‘áº¿n `us-east-1`
* á» chÃ¢u Ã (vÃ­ dá»¥: Hong Kong) sáº½ Ä‘Æ°á»£c chuyá»ƒn hÆ°á»›ng Ä‘áº¿n `ap-southeast-1`
* á» chÃ¢u Ã‚u sáº½ Ä‘Æ°á»£c chuyá»ƒn hÆ°á»›ng Ä‘áº¿n `eu-central-1` (náº¿u cÃ³)

---

### 4. ğŸ›  Cáº¥u hÃ¬nh báº£n ghi Latency trong Route 53

#### Táº¡o 3 báº£n ghi A cho domain `latency.stephanetheteacher.com`:

| Region         | IP Address       | Routing Policy | Record ID      |
| -------------- | ---------------- | -------------- | -------------- |
| ap-southeast-1 | (IP á»Ÿ Singapore) | **Latency**    | ap-southeast-1 |
| us-east-1      | (IP á»Ÿ Má»¹)        | **Latency**    | us-east-1      |
| eu-central-1   | (IP á»Ÿ Äá»©c)       | **Latency**    | eu-central-1   |

* Khi dÃ¹ng IP trá»±c tiáº¿p (khÃ´ng dÃ¹ng Alias), báº¡n cáº§n **tá»± xÃ¡c Ä‘á»‹nh Region** thá»§ cÃ´ng trong cáº¥u hÃ¬nh (vÃ¬ Route 53 khÃ´ng biáº¿t IP thuá»™c region nÃ o).

---

### 5. ğŸ§ª Kiá»ƒm tra hoáº¡t Ä‘á»™ng

#### âœ… TrÆ°á»ng há»£p 1: NgÆ°á»i dÃ¹ng á»Ÿ **ChÃ¢u Ã‚u**

* Truy cáº­p domain â†’ Tráº£ vá» IP tá»« **eu-central-1**
* DÃ¹ng lá»‡nh `dig latency.stephanetheteacher.com` â†’ Tráº£ vá» IP á»Ÿ chÃ¢u Ã‚u.

#### âœ… TrÆ°á»ng há»£p 2: NgÆ°á»i dÃ¹ng á»Ÿ **Canada**

* DÃ¹ng **VPN chuyá»ƒn IP sang Canada**
* Truy cáº­p láº¡i â†’ Tráº£ vá» IP tá»« **us-east-1**
* TTL trong DNS Ä‘Æ°á»£c lÃ m má»›i nÃªn record má»›i Ä‘Æ°á»£c Ã¡p dá»¥ng.

#### âœ… TrÆ°á»ng há»£p 3: NgÆ°á»i dÃ¹ng á»Ÿ **Hong Kong**

* DÃ¹ng VPN Ä‘áº¿n gáº§n Singapore
* Truy cáº­p láº¡i â†’ Tráº£ vá» IP tá»« **ap-southeast-1**

---

### 6. âš ï¸ LÆ°u Ã½:

* TTL cÃ³ thá»ƒ áº£nh hÆ°á»Ÿng Ä‘áº¿n viá»‡c cáº­p nháº­t káº¿t quáº£ Ä‘á»‹nh tuyáº¿n.
* DÃ¹ng **VPN** lÃ  cÃ¡ch Ä‘Æ¡n giáº£n Ä‘á»ƒ mÃ´ phá»ng ngÆ°á»i dÃ¹ng á»Ÿ nhiá»u khu vá»±c.
* **CloudShell** hoáº·c mÃ¡y chá»§ váº«n giá»¯ nguyÃªn region cá»‘ Ä‘á»‹nh nÃªn khÃ´ng pháº£n Ã¡nh Ä‘Æ°á»£c viá»‡c chuyá»ƒn vÃ¹ng.

---

## âœ… Tá»•ng káº¿t:

* **Latency-based Routing Policy** giÃºp tÄƒng tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng báº±ng cÃ¡ch giáº£m Ä‘á»™ trá»… khi truy cáº­p á»©ng dá»¥ng.
* PhÃ¹ há»£p cho á»©ng dá»¥ng phÃ¢n tÃ¡n toÃ n cáº§u, cáº§n tá»‘i Æ°u **tá»‘c Ä‘á»™ pháº£n há»“i**.
* YÃªu cáº§u:

  * CÃ¡c record cÃ³ cÃ¹ng **tÃªn domain** vÃ  **kiá»ƒu (A, AAAA, v.v.)**
  * Má»—i record pháº£i gÃ¡n Ä‘Ãºng **Region**
  * CÃ³ thá»ƒ gáº¯n **Health Check**

---
