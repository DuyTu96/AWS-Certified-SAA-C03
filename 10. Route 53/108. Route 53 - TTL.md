## ğŸ” Giá»›i thiá»‡u vá» **TTL (Time To Live)** trong DNS â€“ Route 53

---

### âœ… **TTL lÃ  gÃ¬?**

* TTL (Time To Live): lÃ  thá»i gian sá»‘ng cá»§a má»™t báº£n ghi DNS.
* Khi client gá»­i yÃªu cáº§u DNS tá»›i Route 53 Ä‘á»ƒ phÃ¢n giáº£i tÃªn miá»n (vÃ­ dá»¥: `myapp.example.com`), DNS tráº£ vá»:

  * **Loáº¡i báº£n ghi (A record)**
  * **Äá»‹a chá»‰ IP**
  * **TTL**, vÃ­ dá»¥: `300 giÃ¢y`

ğŸ‘‰ TTL yÃªu cáº§u client **cache káº¿t quáº£ trong khoáº£ng thá»i gian TTL**.

---

### ğŸ”„ **CÃ¡ch hoáº¡t Ä‘á»™ng cá»§a TTL**

* Khi client truy cáº­p láº¡i cÃ¹ng hostname trong thá»i gian TTL:

  * KHÃ”NG cáº§n truy váº¥n láº¡i DNS
  * TrÃ¬nh duyá»‡t hoáº·c há»‡ Ä‘iá»u hÃ nh sáº½ sá»­ dá»¥ng báº£n ghi Ä‘Ã£ cache

â¡ï¸ Giáº£m sá»‘ lÆ°á»£ng truy váº¥n DNS â†’ giáº£m táº£i lÃªn Route 53
â¡ï¸ Tuy nhiÃªn, náº¿u IP thay Ä‘á»•i thÃ¬ client sáº½ **chÆ°a nháº­n Ä‘Æ°á»£c báº£n ghi má»›i** cho Ä‘áº¿n khi TTL háº¿t háº¡n.

---

### ğŸ“Š Hai trÆ°á»ng há»£p TTL Ä‘iá»ƒn hÃ¬nh:

#### 1. **TTL cao (VD: 24 giá»)**

* Ãt truy váº¥n Ä‘áº¿n Route 53 â†’ **giáº£m chi phÃ­**
* Dá»… gÃ¢y lá»—i náº¿u báº¡n **thay Ä‘á»•i IP** â†’ client sáº½ khÃ´ng cáº­p nháº­t ngay
* PhÃ¹ há»£p khi há»‡ thá»‘ng **á»•n Ä‘á»‹nh, Ã­t thay Ä‘á»•i**

#### 2. **TTL tháº¥p (VD: 60 giÃ¢y)**

* Truy váº¥n nhiá»u hÆ¡n â†’ **tÄƒng chi phÃ­**
* Báº£n ghi sáº½ Ä‘Æ°á»£c cáº­p nháº­t **nhanh chÃ³ng**
* ThÃ­ch há»£p khi cáº§n **chuyá»ƒn hÆ°á»›ng, cáº­p nháº­t IP linh hoáº¡t**

ğŸ§  **Chiáº¿n lÆ°á»£c hay:**
TrÆ°á»›c khi thay Ä‘á»•i IP báº£n ghi:

* Giáº£m TTL xuá»‘ng tháº¥p (vÃ­ dá»¥ 60s)
* Äá»£i client háº¿t cache
* Cáº­p nháº­t IP má»›i
* Sau Ä‘Ã³ tÄƒng TTL trá»Ÿ láº¡i

---

## ğŸ› ï¸ Demo TTL trong thá»±c táº¿

---

### âœ… **Táº¡o báº£n ghi A trÃªn Route 53**

1. TÃªn báº£n ghi: `demo.stephanetheteacher.com`
2. Trá» Ä‘áº¿n IP cá»§a **EC2 á»Ÿ Frankfurt (eu-central-1)**
3. TTL: **120 giÃ¢y (2 phÃºt)**

---

### âœ… **Kiá»ƒm tra báº£n ghi**

* Má»Ÿ báº±ng **Google Chrome** â†’ tháº¥y dÃ²ng `"Hello from AZ eu-central-1b"`
* Kiá»ƒm tra báº±ng lá»‡nh:

  * `nslookup demo.stephanetheteacher.com`
  * `dig demo.stephanetheteacher.com` â†’ hiá»ƒn thá»‹ IP & TTL

â± TTL sáº½ **giáº£m dáº§n theo thá»i gian** (vÃ­ dá»¥ tá»« 120 â†’ 98s...)

---

### ğŸ”„ **Cáº­p nháº­t báº£n ghi DNS**

1. Thay Ä‘á»•i IP báº£n ghi sang **EC2 á»Ÿ Singapore (ap-southeast-1)**
2. Ngay sau khi cáº­p nháº­t:

   * TrÃ¬nh duyá»‡t **váº«n truy cáº­p Frankfurt**
   * VÃ¬ káº¿t quáº£ cÅ© váº«n cÃ²n trong **cache TTL**
3. Sau khi TTL háº¿t:

   * TrÃ¬nh duyá»‡t má»›i truy váº¥n DNS láº¡i
   * Hiá»ƒn thá»‹ dÃ²ng `"Hello from ap-southeast-1b"`

---

### âœ… Káº¿t luáº­n

* TTL giÃºp kiá»ƒm soÃ¡t **táº§n suáº¥t truy váº¥n DNS** vÃ  **kháº£ nÄƒng pháº£n á»©ng khi thay Ä‘á»•i IP**
* LuÃ´n kiá»ƒm tra TTL hiá»‡n táº¡i báº±ng `dig`
* Ãp dá»¥ng TTL tháº¥p khi cáº§n **thay Ä‘á»•i nhanh**
* TTL lÃ  **báº¯t buá»™c** vá»›i má»i báº£n ghi **trá»« Alias record**

---

