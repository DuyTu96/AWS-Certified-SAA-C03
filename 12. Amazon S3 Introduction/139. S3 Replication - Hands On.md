## ğŸ§ª Thá»±c hÃ nh **Amazon S3 Replication**

### 1. Táº¡o bucket nguá»“n (origin bucket):

* VÃ­ dá»¥: `s3-stephane-bucket-origin-v2`, Ä‘áº·t táº¡i region **eu-west-1**.
* **Enable versioning** vÃ¬ replication chá»‰ hoáº¡t Ä‘á»™ng náº¿u bucket Ä‘Ã£ báº­t versioning.

---

### 2. Táº¡o bucket Ä‘Ã­ch (replica bucket):

* VÃ­ dá»¥: `s3-stephane-bucket-replica-v2`, cÃ³ thá»ƒ:

  * **Same region** â sáº½ lÃ  **SRR** (Same-Region Replication).
  * **Different region** (vÃ­ dá»¥: `us-east-1`) â sáº½ lÃ  **CRR** (Cross-Region Replication).
* **Enable versioning** cho cáº£ bucket Ä‘Ã­ch.

---

### 3. Thiáº¿t láº­p replication rule:

* VÃ o **Management** trong bucket nguá»“n.
* Táº¡o **replication rule**, vÃ­ dá»¥: `DemoReplicationRule`.
* **Rule scope**: Ã¡p dá»¥ng cho **táº¥t cáº£ object** trong bucket.
* **Destination bucket**: chá»n bucket Ä‘Ã­ch (cÃ³ thá»ƒ cÃ¹ng tÃ i khoáº£n hoáº·c khÃ¡c tÃ i khoáº£n).
* **IAM Role**: táº¡o má»›i Ä‘á»ƒ cáº¥p quyá»n cho S3 thá»±c hiá»‡n replication.
* **LÆ°u Ã½**: khi thiáº¿t láº­p, báº¡n sáº½ Ä‘Æ°á»£c há»i:

  * CÃ³ replicate cÃ¡c **existing objects** khÃ´ng?
  * Tráº£ lá»i **No** vÃ¬ muá»‘n replicate object cÅ© thÃ¬ pháº£i dÃ¹ng **S3 Batch Replication** riÃªng.

---

### 4. Kiá»ƒm tra replication:

* Upload file má»›i (vÃ­ dá»¥: `coffee.jpg`) lÃªn **bucket nguá»“n**.
* Sau vÃ i giÃ¢y, file sáº½ Ä‘Æ°á»£c replicate sang **bucket Ä‘Ã­ch**.
* Kiá»ƒm tra `version ID`: sáº½ giá»‘ng nhau á»Ÿ cáº£ hai bucket.

---

### 5. Replicate láº¡i object cÅ©:

* Muá»‘n replicate file Ä‘Ã£ tá»“n táº¡i trÆ°á»›c Ä‘Ã³ (vÃ­ dá»¥ `beach.jpg`):

  * Cáº§n **re-upload** Ä‘á»ƒ táº¡o **new version** â†’ lÃºc Ä‘Ã³ má»›i Ä‘Æ°á»£c replicate.
  * Hoáº·c dÃ¹ng **S3 Batch Operation** náº¿u muá»‘n replicate toÃ n bá»™ object cÅ©.

---

### 6. Xá»­ lÃ½ **delete marker**:

* Máº·c Ä‘á»‹nh: **delete marker** sáº½ **khÃ´ng Ä‘Æ°á»£c replicate**.
* CÃ³ thá»ƒ báº­t tÃ¹y chá»n **delete marker replication** trong replication rule.

#### âœ” Khi báº­t tÃ­nh nÄƒng nÃ y:

* XÃ³a file (vÃ­ dá»¥ `coffee.jpg`) á»Ÿ bucket nguá»“n â†’ S3 sáº½ táº¡o **delete marker**.
* Marker nÃ y sáº½ **Ä‘Æ°á»£c replicate** sang bucket Ä‘Ã­ch.
* Náº¿u khÃ´ng báº­t **Show versions**, file sáº½ **biáº¿n máº¥t** á»Ÿ cáº£ 2 bucket.
* NhÆ°ng náº¿u báº­t **Show versions**, váº«n tháº¥y Ä‘Æ°á»£c **cÃ¡c phiÃªn báº£n cÅ©** vÃ  **delete marker**.

---

### 7. âš ï¸ LÆ°u Ã½ vá» **permanent delete**:

* Náº¿u xÃ³a **má»™t version cá»¥ thá»ƒ** (permanent delete) thÃ¬:

  * **Sáº½ khÃ´ng Ä‘Æ°á»£c replicate** sang bucket Ä‘Ã­ch.
  * Äiá»u nÃ y giÃºp ngÄƒn cháº·n **xÃ³a Ã¡c Ã½ (malicious delete)**.

---

## âœ… Tá»•ng káº¿t:

| TÃ­nh nÄƒng           | MÃ´ táº£                                                           |
| ------------------- | --------------------------------------------------------------- |
| Versioning          | Báº¯t buá»™c Ä‘á»ƒ sá»­ dá»¥ng replication                                 |
| CRR & SRR           | CRR: cross-region, SRR: same-region                             |
| Replicate object cÅ© | DÃ¹ng **S3 Batch Replication**                                   |
| Delete marker       | CÃ³ thá»ƒ replicate (pháº£i báº­t trong rule)                          |
| Permanent delete    | âŒ KhÃ´ng replicate                                               |
| Version ID          | ÄÆ°á»£c replicate, Ä‘áº£m báº£o sá»± Ä‘á»“ng nháº¥t giá»¯a source vÃ  destination |

---

