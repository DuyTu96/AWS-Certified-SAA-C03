# 79. Gateway Load Balancer (GWLB)

## ğŸ” **Gateway Load Balancer (GWLB) â€“ Load Balancer kiá»ƒu má»›i nháº¥t**

### ğŸ“Œ **Má»¥c Ä‘Ã­ch sá»­ dá»¥ng:**

Gateway Load Balancer Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ **triá»ƒn khai, má»Ÿ rá»™ng vÃ  quáº£n lÃ½ cÃ¡c thiáº¿t bá»‹ máº¡ng trung gian (third-party network appliances)** nhÆ°:

* **Firewall**
* **Intrusion Detection & Prevention System (IDPS)**
* **Deep Packet Inspection**
* **Payload Modification á»Ÿ má»©c network**

---

### ğŸ§  **Ká»‹ch báº£n sá»­ dá»¥ng:**

* BÃ¬nh thÆ°á»ng, ngÆ°á»i dÃ¹ng **truy cáº­p trá»±c tiáº¿p** Ä‘áº¿n á»©ng dá»¥ng qua **Application Load Balancer (ALB)**.
* Vá»›i GWLB, **toÃ n bá»™ lÆ°u lÆ°á»£ng máº¡ng** sáº½ Ä‘Æ°á»£c **chuyá»ƒn qua cÃ¡c thiáº¿t bá»‹ kiá»ƒm tra trung gian** (VD: firewall) **trÆ°á»›c khi Ä‘áº¿n á»©ng dá»¥ng**.

---

### ğŸ” **CÃ¡ch hoáº¡t Ä‘á»™ng (theo sÆ¡ Ä‘á»“ mÃ´ táº£):**

1. NgÆ°á»i dÃ¹ng gá»­i traffic.
2. Traffic **Ä‘Æ°á»£c Ä‘á»‹nh tuyáº¿n Ä‘áº¿n Gateway Load Balancer**.
3. GWLB **phÃ¢n phá»‘i traffic Ä‘áº¿n Target Group** chá»©a cÃ¡c **virtual appliances** (thÆ°á»ng lÃ  EC2).
4. CÃ¡c appliance sáº½:

   * **PhÃ¢n tÃ­ch traffic** (firewall, IDPSâ€¦)
   * **Cháº·n** náº¿u khÃ´ng há»£p lá»‡
   * **Cháº¥p nháº­n** thÃ¬ tráº£ ngÆ°á»£c vá» GWLB
5. GWLB sáº½ **forward traffic Ä‘áº¿n á»©ng dá»¥ng**
6. **á»¨ng dá»¥ng hoÃ n toÃ n â€œtransparentâ€**, khÃ´ng biáº¿t traffic Ä‘Ã£ bá»‹ kiá»ƒm duyá»‡t.

---

### ğŸ“¶ **Hoáº¡t Ä‘á»™ng á»Ÿ Layer nÃ o?**

* **Layer 3**: Má»©c **Network** (IP packet level)
* Sá»­ dá»¥ng nhÆ° má»™t:

  * **Transparent Network Gateway**
  * **Load Balancer** (phÃ¢n phá»‘i lÆ°u lÆ°á»£ng Ä‘áº¿n cÃ¡c thiáº¿t bá»‹)

---

### ğŸ“¦ **Target Group cá»§a Gateway Load Balancer:**

* **Third-party appliances** cÃ³ thá»ƒ lÃ :

  * **EC2 instance** (Ä‘Äƒng kÃ½ báº±ng Instance ID)
  * **IP address** (chá»‰ dÃ¹ng Private IP)

    * VÃ­ dá»¥: cÃ¡c thiáº¿t bá»‹ Ä‘áº·t táº¡i **data center riÃªng**.

---

### ğŸ”Œ **Giao thá»©c Ä‘áº·c biá»‡t:**

* GWLB sá»­ dá»¥ng giao thá»©c **GENEVE** (Generic Network Virtualization Encapsulation)

  * **Port**: `6081`
  * ÄÃ¢y lÃ  dáº¥u hiá»‡u Ä‘áº·c trÆ°ng nháº­n biáº¿t má»™t Gateway Load Balancer.

---

### ğŸ§ª **Thá»±c hÃ nh:**

* Do GWLB liÃªn quan Ä‘áº¿n cáº¥u hÃ¬nh máº¡ng phá»©c táº¡p (**Route Table**, **Private IP**, **Firewall EC2 Appliance**...), nÃªn **khÃ´ng thá»±c hiá»‡n thá»±c hÃ nh trá»±c tiáº¿p** trong bÃ i nÃ y.

---

### âœ… **Tá»•ng káº¿t kiáº¿n thá»©c chÃ­nh:**

| ThÃ nh pháº§n               | Ghi chÃº                                                       |
| ------------------------ | ------------------------------------------------------------- |
| TÃªn dá»‹ch vá»¥              | **Gateway Load Balancer (GWLB)**                              |
| DÃ¹ng cho                 | Firewall, IDPS, DPI, Payload rewrite                          |
| Hoáº¡t Ä‘á»™ng á»Ÿ lá»›p máº¡ng nÃ o | **Layer 3 â€“ Network Layer (IP)**                              |
| Giao thá»©c                | **GENEVE**, Port **6081**                                     |
| Target Group             | EC2 instance hoáº·c IP address (Private IP)                     |
| TÃ­nh nÄƒng                | Gateway + Load Balancer cho network appliances                |
| Äá»‹nh tuyáº¿n               | Cáº§n cáº¥u hÃ¬nh láº¡i **Route Tables**                             |
| á»¨ng dá»¥ng                 | KhÃ´ng cáº§n biáº¿t traffic Ä‘Ã£ Ä‘i qua kiá»ƒm duyá»‡t â†’ **transparent** |

---
